<html>


<head>
    <script src="https://code.jquery.com/jquery-3.2.0.min.js"></script>

    <title> Library of Congress - Image Search</title>
    <script>
        var sampleData = {
            "results": [
                {
                    "title": "hjhjhSAMPLE: Michigan, Detroit, Campus Martius",
                    "created_published_date": "[between 1920 and 1940]",
                    "image": {
                        "full": "//www.loc.gov/pictures/cdn/service/pnp/cph/3c20000/3c23000/3c23000/3c23096_150px.jpg",
                        "square": "//cdn.loc.gov/service/pnp/cph/3c20000/3c23000/3c23000/3c23096_75x75px.jpg",
                    },
                    "links": {
                        "item": "//www.loc.gov/pictures/item/99403554/",
                        "resource": "//www.loc.gov/pictures/item/99403554/resource/"
                    },
                },
                {
                    "title": "SAMPLE: [Shubert's Detroit Opera House, Campus Martins, Detroit, Michigan]",
                    "created_published_date": "1929.",
                    "image": {
                        "full": "//www.loc.gov/pictures/cdn/service/pnp/cph/3c30000/3c34000/3c34900/3c34960_150px.jpg",
                        "square": "//cdn.loc.gov/service/pnp/cph/3c30000/3c34000/3c34900/3c34960_75x75px.jpg",
                    },
                    "links": {
                        "item": "//www.loc.gov/pictures/item/2004675446/",
                        "resource": "//www.loc.gov/pictures/item/2004675446/resource/"
                    },
                },
                {
                    "title": "SAMPLE: [Detroit, Mich., Campus Martius and Opera House]",
                    "created_published_date": "[between 1900 and 1910]",
                    "image": {
                        "full": "//www.loc.gov/pictures/cdn/service/pnp/det/4a10000/4a18000/4a18900/4a18953r.jpg",
                        "square": "//cdn.loc.gov/service/pnp/det/4a10000/4a18000/4a18900/4a18953_75x75px.jpg",
                    },
                    "links": {
                        "item": "//www.loc.gov/pictures/item/det1994001536/PP/",
                        "resource": "//www.loc.gov/pictures/item/det1994001536/PP/resource/"
                    },
                },
                {
                    "title": "SAMPLE: [Detroit, Mich., Campus Martius]",
                    "created_published_date": "[between 1900 and 1920]",
                    "image": {
                        "full": "//www.loc.gov/pictures/cdn/service/pnp/det/4a20000/4a25000/4a25100/4a25139r.jpg",
                        "square": "//cdn.loc.gov/service/pnp/det/4a20000/4a25000/4a25100/4a25139_75x75px.jpg",
                    },
                    "links": {
                        "item": "//www.loc.gov/pictures/item/det1994002132/PP/",
                        "resource": "//www.loc.gov/pictures/item/det1994002132/PP/resource/"
                    },
                },
                {
                    "title": "SAMPLE: The Campus, Detroit, Mich.",
                    "created_published_date": "[between 1900 and 1910]",
                    "image": {
                        "full": "//www.loc.gov/pictures/cdn/service/pnp/det/4a10000/4a10000/4a10100/4a10101r.jpg",
                        "square": "//cdn.loc.gov/service/pnp/det/4a10000/4a10000/4a10100/4a10101_75x75px.jpg",
                    },
                    "links": {
                        "item": "//www.loc.gov/pictures/item/det1994008356/PP/",
                        "resource": "//www.loc.gov/pictures/item/det1994008356/PP/resource/"
                    },
                },
            ]
        };
    </script>
</head>

<body>

    <h2>Library of Congress - Image Search</h2>

    <br />
    <!--Suggestions:
    <br /> Dorothea Lange
    <br />Detroit Campus Martius
    <br />-->

    <input id="searchText" type="text" size="100" value="Migrant Mother. Dorothea Lange" />

    <br />
    <br />
    <button onclick="testJSON()">
        <i class="fa fa-edit"></i> Search JSON
    </button> (Local JSON Object)

    <br />
    <button onclick="testRemote()">
        <i class="fa fa-edit"></i> Search External LOC
    </button> (External LOC Endpoint)

    <br />
    <button onclick="testLocal()">
        <i class="fa fa-edit"></i> Search Custom
    </button> (Custom Endpoint - Sample data)

    <br />
    <button onclick="testLocalADONet()">
        <i class="fa fa-edit"></i> Search Custom ADONet
    </button> (Custom Endpoint - Database data using ADO.Net)

    <br />
    <button onclick="testLocalEntity()">
        <i class="fa fa-edit"></i> Search Custom Entity
    </button> (Custom Endpoint - Database data using Entity Framework)
    <br />
    <button onclick="testLocalAWEntity()">
        <i class="fa fa-edit"></i> Search Custom Entity
    </button> (Custom Endpoint - Database data using Entity Framework)

    <table border="1" id="resultsTable">
        <tr>
            <th>date</th>
            <th>title</th>
            <th>thumb</th>
        </tr>
    </table>

    <script>
        function addRowToTable(item) {
            var row = $("<tr />")
            $("#resultsTable").append(row); //this will append tr element to table... keep its reference for a while since we will add cels into it
            row.append($("<td>" + item.created_published_date + "</td>"));
            row.append($("<td>" + "<a target='_blank' href='" + ((item.links) ? item.links.item : "") + "'>" + item.title + "</a>" + "</td>"));
            row.append($("<td>" + "<a target='_blank' href='" + ((item.links) ? item.links.resource : "") + "'>"
                + '<img src="' + ((item.image) ? item.image.square : "") + '" />' + "</a>" + "</td>"));
        }

        function loadData(data) {
            $("#resultsTable tr:gt(0)").remove();
            //alert("AAAA" + JSON.stringify(data, null, "  "))
            var list = data.results;
            for (var i = 0; i < list.length; i++) {
                var item = list[i];
                addRowToTable(item);
            }
        }
        loadData(sampleData);

        function testJSON() {
            loadData(sampleData);
        }

        function testRemote() {
            var search = $("#searchText").val();
            $.ajax({
                type: 'get',
                url: 'http://www.loc.gov/pictures/search/',
                dataType: 'jsonp',
                data: {
                    fo: 'json',
                    at: 'results',
                    query: search
                },
                success: function (response) {
                    loadData(response);
                },
                error: function (errorObject) {
                    alert("error: " + errorObject.responseText)
                }
            })
        }

        function testLocal() {
            // alert('click' + $("#searchText").val())
            var search = $("#searchText").val();
            $.ajax({
                type: 'get',
                url: 'http://localhost:29594/api/loc/',
                dataType: 'json',
                data: {
                    fo: 'json',
                    at: 'results',
                    query: search
                },
                success: function (response) {
                    loadData(response);
                },
                error: function (errorObject) {
                    alert("error: " + errorObject.responseText)
                }
            })
        }
        function testLocalADONet() {
            // alert('click' + $("#searchText").val())
            var search = $("#searchText").val();
            $.ajax({
                type: 'get',
                url: 'http://localhost:29594/api/locdb/',
                dataType: 'json',
                data: {
                    fo: 'json',
                    at: 'results',
                    query: search
                },
                success: function (response) {
                    loadData(response);
                },
                error: function (errorObject) {
                    alert("error: " + errorObject.responseText)
                }
            })
        }
        function testLocalEntity() {
            // alert('click' + $("#searchText").val())
            var search = $("#searchText").val();
            $.ajax({
                type: 'get',
                url: 'http://localhost:29594/api/LOCEntity/',
                dataType: 'json',
                data: {
                    fo: 'json',
                    at: 'results',
                    query: search
                },
                success: function (response) {
                    loadData(response);
                },
                error: function (errorObject) {
                    alert("error: " + errorObject.responseText)
                }
            })
        }
        function testLocalAWEntity() {
            // alert('click' + $("#searchText").val())
            var search = $("#searchText").val();
            $.ajax({
                type: 'get',
                url: 'http://localhost:29594/api/AWEntity/',
                //crossDomain: true,
                //xhrFields: {
                //    withCredentials: true
                //},
                dataType: 'json',
                data: {
                    fo: 'json',
                    at: 'results',
                    query: search
                },
                success: function (response) {
                    loadData(response);
                },
                error: function (errorObject) {
                    alert("error: " + errorObject.responseText)
                }
            })
        }
    </script>

</body>

</html>